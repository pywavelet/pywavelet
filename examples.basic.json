{"version":3,"kind":"Notebook","sha256":"35d06cc30bd0b3e0b07cac27d54abfb3a4ef2d87fd739f318cde49fc10765eb7","slug":"examples.basic","location":"/examples/basic.ipynb","dependencies":[],"frontmatter":{"title":"Example","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"pywavelet developers","given":"pywavelet","family":"developers"},"name":"pywavelet developers","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pywavelet/pywavelet","settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/pywavelet/pywavelet/blob/main/docs/examples/basic.ipynb","edit_url":"https://github.com/pywavelet/pywavelet/edit/main/docs/examples/basic.ipynb","thumbnail":"/pywavelet//build/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"ipynb","filename":"basic.ipynb","url":"/pywavelet//build/basic-6eaf12f532d1586766ac6c7e74473c5b.ipynb"}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{},"version_major":2,"version_minor":0}},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"link","url":"https://colab.research.google.com/github/pywavelet/pywavelet/blob/main/docs/example.ipynb","children":[{"type":"image","url":"/pywavelet//build/7e2db436150c38a00650f96925aa5581.svg","alt":"Open In Colab","key":"GzuZgJjWst","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/pywavelet/pywavelet/blob/main/docs/example.ipynb","key":"AnCv1NZOBi"},{"type":"heading","depth":1,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Example","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"m7g7PqAmwd"}],"identifier":"example","label":"Example","html_id":"example","implicit":true,"key":"YKW9OEsqCc"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Time to Wavelet","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"bFgu87Je26"}],"identifier":"time-to-wavelet","label":"Time to Wavelet","html_id":"time-to-wavelet","implicit":true,"key":"yKh8O1lJtr"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Let’s transform a time-domain signal (of length ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PNeOIpGxD8"},{"type":"inlineMath","value":"N","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"DIWthZnxeD"},{"type":"text","value":"), to the wavelet-domain (of shape ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"GvhJkQYiut"},{"type":"inlineMath","value":"N_t\\times N_f","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>t</mi></msub><mo>×</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><annotation encoding=\"application/x-tex\">N_t\\times N_f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KJkNU57dZK"},{"type":"text","value":") and back to time-domain.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"GIhizoX2ki"}],"key":"shmGMpTo4A"}],"visibility":"show","key":"D3QmPid3b8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"! pip install pywavelet -q","key":"aQkR7FY2Re"},{"type":"outputs","id":"D9nwXil4v_NOwt5JWHRd3","children":[],"key":"qq4zk7tr2t"}],"key":"LrjPQxN3D3"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2025-01-23T03:42:44.922293Z","start_time":"2025-01-23T03:42:43.279788Z"},"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.signal import chirp\nimport numpy as np\nfrom typing import List\nimport matplotlib.pyplot as plt\n\nfrom pywavelet.types import TimeSeries\nfrom pywavelet.transforms import from_time_to_wavelet, from_wavelet_to_time\n\n\ndef generate_chirp_time_domain_signal(\n    t: np.ndarray, freq_range: List[float]\n) -> TimeSeries:\n    fs = 1 / (t[1] - t[0])\n    nyquist = fs / 2\n    fmax = max(freq_range)\n    assert (\n        fmax < nyquist\n    ), f\"f_max [{fmax:.2f} Hz] must be less than f_nyquist [{nyquist:2f} Hz].\"\n\n    y = chirp(\n        t, f0=freq_range[0], f1=freq_range[1], t1=t[-1], method=\"hyperbolic\"\n    )\n    return TimeSeries(data=y, time=t)\n\n\ndef plot_residuals(ax, residuals):\n    ax.hist(residuals, bins=100)\n    # add textbox of mean and std\n    mean = residuals.mean()\n    std = residuals.std()\n    textstr = f\"$\\mu={mean:.1E}$\\n$\\sigma={std:.1E}$\"\n    props = dict(boxstyle=\"round\", facecolor=\"wheat\", alpha=0.5)\n    ax.text(\n        0.05,\n        0.95,\n        textstr,\n        transform=ax.transAxes,\n        fontsize=14,\n        verticalalignment=\"top\",\n        bbox=props,\n    )\n    ax.set_xlabel(\"Residuals\")\n    ax.set_ylabel(\"Count\")\n    ax.ticklabel_format(axis=\"x\", style=\"sci\", scilimits=(0, 0))\n    return ax\n\n\n# Sizes\ndt = 1 / 512\nNt, Nf = 2**6, 2**6\nmult = 16\nfreq_range = (10, 0.2 * (1 / dt))\nND = Nt * Nf\n\n# time grid\nts = np.arange(0, ND) * dt\nh_time = generate_chirp_time_domain_signal(ts, freq_range)\n\n\n# transform to wavelet domain\nh_wavelet = from_time_to_wavelet(h_time, Nf=Nf, Nt=Nt, mult=mult)\n\n# transform back to time domain\nh_reconstructed = from_wavelet_to_time(h_wavelet, dt=h_time.dt, mult=mult)\n\n# Plots\nfig, axes = plt.subplots(1, 4, figsize=(18, 4))\n_ = h_time.plot_spectrogram(ax=axes[0])\n_ = h_wavelet.plot(ax=axes[1], absolute=True, cmap=\"Reds\")\n_ = h_reconstructed.plot_spectrogram(ax=axes[2])\n_ = plot_residuals(axes[3], h_time.data - h_reconstructed.data)\naxes[0].set_title(\"Original Time Domain\")\naxes[1].set_title(\"Wavelet Domain\")\naxes[2].set_title(\"Reconstructed Time Domain\")\naxes[3].set_title(\"Residuals\")\nfor ax in axes[0:3]:\n    ax.set_ylim(*freq_range)\nfig.savefig(\"roundtrip_time.png\")\nplt.close()","visibility":"show","key":"fS3XhZm0M7"},{"type":"outputs","id":"g2Ivt7bxW0ehi0--ziApL","children":[],"visibility":"show","key":"TitlE36veb"}],"visibility":"hide","key":"WP6pzOoGeu"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Provide data as a TimeSeries/FrequencySeries object","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BkkWoMmzMl"}],"key":"TBjXBrHWn2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"These objects will ensure correct bins for time/frequency in the WDM-domain.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E3NkdpnDPU"}],"key":"ySR3zdJPd5"}],"class":"tip","key":"I3mPbnyTvS"},{"type":"image","url":"/pywavelet//build/roundtrip_time-f7fb0247c32ab88ffe7a572373ad2be4.png","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pHpZGH1ha4","urlSource":"roundtrip_time.png"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Freq to Wavelet","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"dBFbqCWMIa"}],"identifier":"freq-to-wavelet","label":"Freq to Wavelet","html_id":"freq-to-wavelet","implicit":true,"key":"e6rQWuwxbt"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"This time, we use a sine-wave in the frequency domain.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vQ18PxD4QJ"}],"key":"QRm5aS60If"}],"key":"k20SQtGDwg"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2025-01-23T03:42:42.572318Z","start_time":"2025-01-23T03:42:39.773430Z"},"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nfrom pywavelet.types import FrequencySeries\nfrom pywavelet.transforms import from_freq_to_wavelet, from_wavelet_to_freq\nimport matplotlib.pyplot as plt\n\nf0 = 20\ndt = 0.0125\nNt = 32\nNf = 256\nN = Nf * Nt\n\nfreq = np.fft.rfftfreq(N, dt)\nhf = np.zeros_like(freq, dtype=np.complex128)\nhf[np.argmin(np.abs(freq - f0))] = 1.0\n\n\nh_freq = FrequencySeries(data=hf, freq=freq)\nh_wavelet = from_freq_to_wavelet(h_freq, Nf=Nf, Nt=Nt)\nh_reconstructed = from_wavelet_to_freq(h_wavelet, dt=h_freq.dt)\n\n\nfig, axes = plt.subplots(1, 2, figsize=(9, 4))\n_ = h_freq.plot(ax=axes[0], label=\"Original\")\n_ = h_wavelet.plot(ax=axes[1], absolute=True, cmap=\"Reds\")\n_ = h_reconstructed.plot(ax=axes[0], ls=\":\", label=\"Reconstructed\")\naxes[1].set_ylim(f0 - 5, f0 + 5)\naxes[0].legend()\nfig.savefig(\"roundtrip_freq.png\")\nplt.close()","visibility":"show","key":"UQnBtStmHB"},{"type":"outputs","id":"orRZEwzk8uRyPtY56gagT","children":[],"visibility":"show","key":"DNVwkQTAJV"}],"visibility":"show","key":"HQRIgyvn1f"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/pywavelet//build/roundtrip_freq-8f55085d79723d492319a696731d0f67.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KUbWqVwSr6","urlSource":"roundtrip_freq.png"}],"key":"AjX2Iwgliy"}],"key":"F8Q8EPIAyU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"API","url":"/api","group":" "},"next":{"title":"Runtime Comparisons","url":"/examples/runtime","group":" "}}},"domain":"http://localhost:3000"}