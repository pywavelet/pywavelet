{"version":3,"kind":"Notebook","sha256":"83daaa93e0def382b5dcb929edcce4f99a5a35cf8f03bf89f2806bf55d7c8a25","slug":"examples.accuracy","location":"/examples/accuracy.ipynb","dependencies":[],"frontmatter":{"title":"Accuracy checks","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"pywavelet developers","given":"pywavelet","family":"developers"},"name":"pywavelet developers","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pywavelet/pywavelet","settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/pywavelet/pywavelet/blob/main/docs/examples/accuracy.ipynb","edit_url":"https://github.com/pywavelet/pywavelet/edit/main/docs/examples/accuracy.ipynb","thumbnail":"/pywavelet//build/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"ipynb","filename":"accuracy.ipynb","url":"/pywavelet//build/accuracy-6def12332dac31107efde159c398e1ac.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"link","url":"https://colab.research.google.com/github/pywavelet/pywavelet/blob/main/docs/examples/accuracy.ipynb","children":[{"type":"image","url":"/pywavelet//build/7e2db436150c38a00650f96925aa5581.svg","alt":"Open In Colab","key":"KGamYKFONK","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/pywavelet/pywavelet/blob/main/docs/examples/accuracy.ipynb","key":"jo2sK4529u"},{"type":"heading","depth":1,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Accuracy checks","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hrjsqTfgXQ"}],"identifier":"accuracy-checks","label":"Accuracy checks","html_id":"accuracy-checks","implicit":true,"key":"cfoZ1J1hi5"}],"visibility":"show","key":"hqXgwcJTf5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"!echo \"GPU info\"\n!nvidia-smi\n!nvidia-smi -L\n! echo \"CPU INFO\"\n!lscpu |grep 'Model name'\n!lscpu | grep 'Core(s) per socket:'\n!lscpu | grep 'Thread(s) per core'\n!free -h --si | awk  '/Mem:/{print $2}'","key":"UyR9ZJHX9u"},{"type":"outputs","id":"4t_Xxfr4DeHROlpcqu885","children":[],"key":"iSIAV9Wson"}],"key":"YT40nXzM79"},{"type":"block","kind":"notebook-code","data":{"collapsed":true,"jupyter":{"outputs_hidden":true}},"children":[{"type":"code","lang":"python","executable":true,"value":"! pip install pywavelet -q","key":"ra0j02oZDJ"},{"type":"outputs","id":"gJPTJ2E1omY0ZL3Bi9iZb","children":[],"key":"P8CKt5H6BJ"}],"key":"hqvfYzymLB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Monochromatic Wavelet check","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Awcc3cHsnp"}],"identifier":"monochromatic-wavelet-check","label":"Monochromatic Wavelet check","html_id":"monochromatic-wavelet-check","implicit":true,"key":"AhscKTN5Uw"}],"key":"bfmq4YW3ET"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2025-05-27T07:11:17.642970Z","start_time":"2025-05-27T07:11:09.288337Z"},"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from pywavelet.types import Wavelet, FrequencySeries, TimeSeries\nfrom pywavelet.types.wavelet_bins import compute_bins\nfrom dataclasses import dataclass\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.colors import Normalize, LogNorm\n\n\n@dataclass\nclass Params:\n    f0: float = 20\n    dt: float = 0.0125\n    A: float = 1\n    Nt: int = 32\n    Nf: int = 32\n\n    @property\n    def list(self):\n        return [self.f0, self.dt, self.A, self.Nt, self.Nf]\n\n    def __repr__(self):\n        return f\"f0={self.f0}, A={self.A}\"\n\n\ndef monochromatic_wnm(\n    f0: float,\n    dt: float,\n    A: float,\n    Nt: int,\n    Nf: int,\n) -> Wavelet:\n    T = Nt * Nf * dt\n    N = Nt * Nf\n    t_bins, f_bins = compute_bins(Nf, Nt, T)\n    wnm = np.zeros((Nt, Nf))\n    m0 = int(f0 * N * dt)\n    f0_bin_idx = int(2 * m0 / Nt)\n    odd_t_indices = np.arange(Nt) % 2 != 0\n    wnm[odd_t_indices, f0_bin_idx] = A * np.sqrt(2 * Nf)\n    return Wavelet(wnm.T, t_bins, f_bins)\n\n\ndef monochromatic_timeseries(\n    f0: float,\n    dt: float,\n    A: float,\n    Nt: int,\n    Nf: int,\n) -> TimeSeries:\n    ND = Nt * Nf\n    t = np.arange(0, ND) * dt\n    y = A * np.sin(2 * np.pi * f0 * t)\n    return TimeSeries(data=y, time=t)\n\n\ndefault_params = Params()\n\n\ndef plot_comparison(params):\n\n    true_wdm = monochromatic_wnm(*params.list)\n    true_tdm = monochromatic_timeseries(*params.list)\n    fdm = true_tdm.to_frequencyseries()\n    wdm = fdm.to_wavelet(Nt=params.Nt, Nf=params.Nf)\n    mse = np.mean((wdm.data - true_wdm.data) ** 2)\n\n    fig, ax = plt.subplots(1, 2, figsize=(7, 3.5), sharex=True, sharey=True)\n    norm = Normalize(vmin=0, vmax=wdm.data.max())\n    kwargs = dict(absolute=True, norm=norm, cmap=\"Blues\", show_colorbar=False)\n    true_wdm.plot(ax=ax[0], **kwargs, label=\"Analytical\")\n    wdm.plot(ax=ax[1], **kwargs, label=\"FD-->WDM\")\n    ax[1].set_ylabel(\"\")\n    # set common colorbar using norm\n    sm = plt.cm.ScalarMappable(cmap=\"Blues\", norm=norm)\n    sm.set_array([])\n    fig.colorbar(\n        sm, ax=ax, orientation=\"vertical\", label=\"Absolute WDM amplitude\"\n    )\n    fig.suptitle(f\"MSE={mse:.2e}\")\n    # tight layout whle accommodating suptitle + colorbar\n    fig.tight_layout(rect=[0, 0, 0.8, 0.95])\n    plt.show()\n\n\nplot_comparison(Params(f0=20, A=1))\nplot_comparison(Params(f0=20.1, A=1))","visibility":"hide","key":"HxreW0TlS7"},{"type":"outputs","id":"xgtwsYPNpHbGlAtX99uOc","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bf0dabf958016fef14a28e2cf384371c","path":"/pywavelet//build/bf0dabf958016fef14a28e2cf384371c.png"},"text/plain":{"content":"<Figure size 700x350 with 3 Axes>","content_type":"text/plain"}}},"children":[],"key":"S3enUZzsrH"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb0a9a0c09d88473f36d34dc4605f447","path":"/pywavelet//build/bb0a9a0c09d88473f36d34dc4605f447.png"},"text/plain":{"content":"<Figure size 700x350 with 3 Axes>","content_type":"text/plain"}}},"children":[],"key":"sW6hNLlUXy"}],"visibility":"show","key":"RDntVuH7zm"}],"visibility":"show","key":"aU3zPeiMb8"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2025-03-25T02:20:43.274785Z","start_time":"2025-03-25T02:20:42.897620Z"},"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"Namp, Nfreq = 10, 20\namplitudes = np.linspace(1, 10, Namp)\nf0s = np.linspace(2, 38, Nfreq)\n\nerrors = np.zeros((Namp, Nfreq))\nfor i, A in enumerate(amplitudes):\n    for j, f0 in enumerate(f0s):\n        p = Params(f0=f0, A=A)\n        true = monochromatic_wnm(*p.list)\n\n        wdm = (\n            monochromatic_timeseries(*p.list)\n            .to_frequencyseries()\n            .to_wavelet(Nt=p.Nt, Nf=p.Nf)\n        )\n        errors[i, j] = np.mean((wdm.data - true.data) ** 2)\n\nfig, ax = plt.subplots(1, 1, figsize=(3.5, 3.5))\n# plot grid of errors as a function of amplitude and frequency\nc = ax.pcolormesh(f0s, amplitudes, errors)\n\nax.set_xlabel(\"f0\")\nax.set_ylabel(\"Amplitude\")\nax.set_title(\"MSE\")\nfig.colorbar(c, ax=ax, label=\"MSE\")","visibility":"show","key":"PzGx7SZZgI"},{"type":"outputs","id":"gH7m1nvm5I5I39r6f0i16","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8a29a6ce04f7a7b9d67909dc8a5a8658","path":"/pywavelet//build/8a29a6ce04f7a7b9d67909dc8a5a8658.png"},"text/plain":{"content":"<Figure size 350x350 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"kktAYFlR2s"}],"visibility":"show","key":"ABP5DMGlDF"}],"visibility":"show","key":"vYabXZbZgc"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2025-03-25T02:20:09.585147Z","start_time":"2025-03-25T02:20:08.875970Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"Namp, Nfreq = 10, 20\namplitudes = np.linspace(1, 10, Namp)\ndefault_wdm = monochromatic_wnm(*default_params.list)\n# arrange f0s such that the bin is  an integer multiple of Delta_F\nf0s = default_wdm.freq[2::2]\n# get midpoints of f0s\n\nNfreq = len(f0s)\n\n\nerrors = np.zeros((Namp, Nfreq))\nfor i, A in enumerate(amplitudes):\n    for j, f0 in enumerate(f0s):\n        p = Params(f0=f0, A=A)\n        true = monochromatic_wnm(*p.list)\n\n        wdm = (\n            monochromatic_timeseries(*p.list)\n            .to_frequencyseries()\n            .to_wavelet(Nt=p.Nt, Nf=p.Nf)\n        )\n        errors[i, j] = np.mean((wdm.data - true.data) ** 2)\n\nfig, ax = plt.subplots(1, 1, figsize=(3.5, 3.5))\n# plot grid of errors as a function of amplitude and frequency\nc = ax.pcolormesh(f0s, amplitudes, errors, norm=LogNorm())\n\nax.set_xlabel(\"f0\")\nax.set_ylabel(\"Amplitude\")\nax.set_title(\"MSE\")\nfig.colorbar(c, ax=ax, label=\"MSE\")","key":"P4983JrdQD"},{"type":"outputs","id":"X8N_9HzJy3uDd96JYyxhk","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7c8603955b925d82bdd5e8f91c98a94f","path":"/pywavelet//build/7c8603955b925d82bdd5e8f91c98a94f.png"},"text/plain":{"content":"<Figure size 350x350 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"cSn3DMZles"}],"key":"hqz6IYxiGa"}],"key":"kHYeK8wTNn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Parseval’s Theorem Test (Energy Conservation)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"alW3Pojcjy"}],"identifier":"parsevals-theorem-test-energy-conservation","label":"Parseval’s Theorem Test (Energy Conservation)","html_id":"parsevals-theorem-test-energy-conservation","implicit":true,"key":"DEEoWce1oe"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The total energy of a signal is the same whether calculated directly in the time domain or indirectly from its Fourier transform in the frequency domain. This means no information is lost during the transformation between time and frequency representations.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aPy55lbPH7"}],"key":"x1k1KBsvMp"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Lets see if this holds true for the wavelet transform. We will use a simple sinusoidal signal and check if the energy in the time domain matches the energy in the frequency domain.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U6UZJe8qBh"}],"key":"Q3kJuJetuf"}],"key":"mco9m8A64p"},{"type":"block","kind":"notebook-code","data":{"ExecuteTime":{"end_time":"2025-05-27T07:17:38.299408Z","start_time":"2025-05-27T07:17:38.259771Z"},"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"ts = monochromatic_timeseries(\n    f0=20,\n    dt=0.0125,\n    A=1,\n    Nt=32,\n    Nf=32,\n)\nwdm = ts.to_wavelet(Nt=32)\n\n\n# Calculate energy in time domain\nenergy_time = np.abs(ts.data) ** 2\nenergy_wavelet = np.abs(wdm.data) ** 2\n\nif np.isclose(\n    np.sum(energy_time), np.sum(energy_wavelet), rtol=1e-5, atol=1e-5\n):\n    print(\"Parseval's theorem holds: Energy is conserved.\")\nelse:\n    print(\"Parseval's theorem does not hold: Energy is not conserved.\")\n    print(f\"Time domain energy: {np.sum(energy_time)}\")\n    print(f\"Wavelet domain energy: {np.sum(energy_wavelet)}\")","key":"HIQfJB5MKg"},{"type":"outputs","id":"yjZlIa9LyFE15F3Y729H0","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Parseval's theorem does not hold: Energy is not conserved.\nTime domain energy: 512.0\nWavelet domain energy: 1024.0\n"},"children":[],"key":"F3Hu80KM1D"}],"key":"SGgc3C13kV"}],"key":"Ptlo2V2ApD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Roundtrip","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d8duBFnFgO"}],"identifier":"roundtrip","label":"Roundtrip","html_id":"roundtrip","implicit":true,"key":"Pu9AVIoeQx"}],"key":"WXpLIw425X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.signal import chirp\nimport numpy as np\nfrom typing import List\nimport matplotlib.pyplot as plt\nimport os\n\nfrom pywavelet.types import TimeSeries, FrequencySeries\n\nPLOT_DIR = f\"backend_plots\"\nos.makedirs(PLOT_DIR, exist_ok=True)\n\n\ndef generate_chirp_time_domain_signal(\n    t: np.ndarray, freq_range: List[float]\n) -> TimeSeries:\n    fs = 1 / (t[1] - t[0])\n    nyquist = fs / 2\n    fmax = max(freq_range)\n    assert (\n        fmax < nyquist\n    ), f\"f_max [{fmax:.2f} Hz] must be less than f_nyquist [{nyquist:2f} Hz].\"\n\n    y = chirp(\n        t, f0=freq_range[0], f1=freq_range[1], t1=t[-1], method=\"hyperbolic\"\n    )\n    return TimeSeries(data=y, time=t)\n\n\ndef plot_residuals(ax, residuals):\n    ax.hist(residuals, bins=100)\n    # add textbox of mean and std\n    mean = residuals.mean()\n    std = residuals.std()\n    textstr = f\"$\\mu={mean:.1E}$\\n$\\sigma={std:.1E}$\"\n    props = dict(boxstyle=\"round\", facecolor=\"wheat\", alpha=0.5)\n    ax.text(\n        0.05,\n        0.95,\n        textstr,\n        transform=ax.transAxes,\n        fontsize=14,\n        verticalalignment=\"top\",\n        bbox=props,\n    )\n    ax.set_xlabel(\"Residuals\")\n    ax.set_ylabel(\"Count\")\n    ax.ticklabel_format(axis=\"x\", style=\"sci\", scilimits=(0, 0))\n    return ax\n\n\ndef plot(h_freq, h_reconstructed, h_wavelet, title=None):\n    fig, axes = plt.subplots(1, 3, figsize=(18, 4))\n    _ = h_freq.plot_periodogram(ax=axes[0], color=\"black\", label=\"Original\")\n    _ = h_reconstructed.plot_periodogram(\n        ax=axes[0], ls=\"--\", color=\"red\", label=\"Reconstructed\"\n    )\n    _ = h_wavelet.plot(ax=axes[1], absolute=True, cmap=\"Reds\")\n    _ = plot_residuals(axes[2], h_freq.data - h_reconstructed.data)\n    axes[0].legend()\n    axes[0].set_title(\"Orig[black] vs Reconstructed[red]\")\n    axes[1].set_title(\"Wavelet Domain\")\n    axes[2].set_title(\"Residuals\")\n    if title is not None:\n        fig.suptitle(title)\n    plt.tight_layout()\n    # remove whitespace in 'title'\n    fname = title.replace(\" \", \"_\") if title else \"roundtrip\"\n    fig.savefig(f\"{PLOT_DIR}/{fname}.png\", dpi=300, bbox_inches=\"tight\")\n    plt.close(fig)\n\n\n# Sizes\ndt = 1 / 512\nNt, Nf = 2**6, 2**6\nmult = 16\nfreq_range = (10, 0.2 * (1 / dt))\nND = Nt * Nf\nts = np.arange(0, ND) * dt\nh_time = generate_chirp_time_domain_signal(ts, freq_range)\nh_freq = h_time.to_frequencyseries()","key":"WGEIB9ZOF6"},{"type":"outputs","id":"Utqvee0-wj4hraXjvogQO","children":[],"key":"HqQIxKBpLz"}],"key":"Nls1dsY2WN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Numpy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vpCDyF6b0r"}],"identifier":"numpy","label":"Numpy","html_id":"numpy","implicit":true,"key":"CcDTqpZ5Ke"}],"key":"pTg4ITaVaL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pywavelet.transforms.numpy import (\n    from_freq_to_wavelet,\n    from_wavelet_to_freq,\n)\n\nh_wavelet = from_freq_to_wavelet(h_freq, Nf=Nf, Nt=Nt)\nh_reconstructed = from_wavelet_to_freq(h_wavelet, dt=dt)\nplot(h_freq, h_reconstructed, h_wavelet, title=\"NumPy Roundtrip\")","key":"e7oco61dfQ"},{"type":"outputs","id":"bFiUh62C3usmxkdFHY2Gp","children":[],"key":"LTa5IXMTrq"}],"key":"ARNku7rUGt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"JAX","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E7TDawFAgf"}],"identifier":"jax","label":"JAX","html_id":"jax","implicit":true,"key":"yVsZ6DnZM1"}],"key":"quFttoEAyW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import jax\n\njax.config.update(\"jax_enable_x64\", True)\n\nfrom pywavelet.transforms.jax import (\n    from_freq_to_wavelet as jax_from_freq_to_wavelet,\n)\nfrom pywavelet.transforms.jax import (\n    from_wavelet_to_freq as jax_from_wavelet_to_freq,\n)\n\njax_h_wavelet = jax_from_freq_to_wavelet(h_freq, Nf=Nf, Nt=Nt)\njax_h_reconstructed = jax_from_wavelet_to_freq(h_wavelet, dt=dt)\nplot(h_freq, jax_h_reconstructed, jax_h_wavelet, title=\"JAX Roundtrip\")","key":"ifvXFzPrAT"},{"type":"outputs","id":"a663-KBrmtIQc204FboUZ","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">[15:26:59] </span><span style=\"color: #808000; text-decoration-color: #808000\">WARNING </span> JAX SUBPACKAGE NOT FULLY TESTED                                                   <a href=\"file:///home/avaj040/Documents/projects/pywavelet/package/src/pywavelet/transforms/jax/__init__.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">__init__.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///home/avaj040/Documents/projects/pywavelet/package/src/pywavelet/transforms/jax/__init__.py#5\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">5</span></a>\n</pre>\n","content_type":"text/html"},"text/plain":{"content":"\u001b[2;36m[15:26:59]\u001b[0m\u001b[2;36m \u001b[0m\u001b[33mWARNING \u001b[0m JAX SUBPACKAGE NOT FULLY TESTED                                                   \u001b]8;id=508557;file:///home/avaj040/Documents/projects/pywavelet/package/src/pywavelet/transforms/jax/__init__.py\u001b\\\u001b[2m__init__.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=14678;file:///home/avaj040/Documents/projects/pywavelet/package/src/pywavelet/transforms/jax/__init__.py#5\u001b\\\u001b[2m5\u001b[0m\u001b]8;;\u001b\\\n","content_type":"text/plain"}}},"children":[],"key":"tUjJMZBnGa"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span><span style=\"color: #000080; text-decoration-color: #000080\">INFO    </span> Jax running on cpu <span style=\"font-weight: bold\">[</span>64bit precision<span style=\"font-weight: bold\">]</span>.                                            <a href=\"file:///home/avaj040/Documents/projects/pywavelet/package/src/pywavelet/transforms/jax/__init__.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">__init__.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///home/avaj040/Documents/projects/pywavelet/package/src/pywavelet/transforms/jax/__init__.py#21\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">21</span></a>\n</pre>\n","content_type":"text/html"},"text/plain":{"content":"\u001b[2;36m          \u001b[0m\u001b[2;36m \u001b[0m\u001b[34mINFO    \u001b[0m Jax running on cpu \u001b[1m[\u001b[0m64bit precision\u001b[1m]\u001b[0m.                                            \u001b]8;id=833239;file:///home/avaj040/Documents/projects/pywavelet/package/src/pywavelet/transforms/jax/__init__.py\u001b\\\u001b[2m__init__.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=93510;file:///home/avaj040/Documents/projects/pywavelet/package/src/pywavelet/transforms/jax/__init__.py#21\u001b\\\u001b[2m21\u001b[0m\u001b]8;;\u001b\\\n","content_type":"text/plain"}}},"children":[],"key":"cz3AScQT9T"}],"key":"RUPDIHUeDw"}],"key":"OxCd0egPH0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"CuPy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"repysUhBr7"}],"identifier":"cupy","label":"CuPy","html_id":"cupy","implicit":true,"key":"aYGBXKcbcw"}],"key":"KuCBnYEdcy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from pywavelet.backend import cuda_is_available\n\nif not cuda_is_available():\n    print(\n        \"CuPy backend is not available. Please install CuPy with CUDA support.\"\n    )\nelse:\n    from pywavelet.transforms.cupy import (\n        from_freq_to_wavelet as cp_from_freq_to_wavelet,\n    )\n    from pywavelet.transforms.cupy import (\n        from_wavelet_to_freq as cp_from_wavelet_to_freq,\n    )\n\n    cp_h_wavelet = cp_from_freq_to_wavelet(h_freq, Nf=Nf, Nt=Nt)\n    cp_h_reconstructed = cp_from_wavelet_to_freq(h_wavelet, dt=dt)\n    plot(h_freq, cp_h_reconstructed, cp_h_wavelet, title=\"CuPy Roundtrip\")","key":"mTX6Z1byca"},{"type":"outputs","id":"5sQDBsDt4WHBsVvEsT8rM","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"CuPy backend is not available. Please install CuPy with CUDA support.\n"},"children":[],"key":"BlMKiHSLie"}],"key":"hLUKLaBrqT"}],"key":"Urrvyh87Um"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OjSkjr3cNG"}],"identifier":"results","label":"Results","html_id":"results","implicit":true,"key":"RbzR7GYfGd"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Backend","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lcS4JU7K7S"}],"key":"jRzHWc1sLC"},{"type":"tableCell","header":true,"align":"center","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Roundtrip Plot","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TKNSN1DBXV"}],"key":"GjDpLWFBpv"}],"key":"PrZ3bIZiQt"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","align":"center","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"NumPy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tSQRWNy53L"}],"key":"VP4tiHIPMU"},{"type":"tableCell","align":"center","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/pywavelet//build/NumPy_Roundtrip-79b6bd1e6cf9cf23a6f567c706494ed0.png","alt":"NumPy Roundtrip","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dytNbSBW0n","urlSource":"backend_plots/NumPy_Roundtrip.png"}],"key":"y5RZ8Lg66b"}],"key":"oBkl8fNMxv"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","align":"center","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"JAX","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BaBgdZA7S8"}],"key":"AO7oXYzC3B"},{"type":"tableCell","align":"center","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"image","url":"/pywavelet//build/JAX_Roundtrip-409f2068cbc1100f636eb81068362476.png","alt":"JAX Roundtrip","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"DcLohslHyx","urlSource":"backend_plots/JAX_Roundtrip.png"}],"key":"Ydz7GOyzXl"}],"key":"oP3IWyCYsE"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","align":"center","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"CuPy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"I0NlI8P6Z3"}],"key":"a4sSalSOv1"},{"type":"tableCell","align":"center","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"(not available in docs build)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"WYAG0w8d95"}],"key":"lozRLvm5f6"}],"key":"WxA9gjRG3x"}],"key":"WunOhCn4vX"}],"key":"g6LBiGDY8K"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Noise robustness","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zeRCWnqqgP"}],"identifier":"noise-robustness","label":"Noise robustness","html_id":"noise-robustness","implicit":true,"key":"BjY1Lm1ko3"}],"key":"cmyA2VG7bU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nfrom pywavelet.types import TimeSeries, FrequencySeries\nfrom time import process_time\n\nnp.random.seed(42)  # For reproducibility\n\n\ndef generate_white_noise(\n    N: int = 2**20, scale: float = 1.0\n) -> FrequencySeries:\n    \"\"\"Generate white noise time series.\"\"\"\n    noise = np.random.normal(0, scale, N)\n    return TimeSeries(data=noise, time=np.arange(N)).to_frequencyseries()\n\n\ndatasets = [generate_white_noise() for _ in range(100)]\n\n\ndef get_residuals(datasets, forward_transform, inverse_transform, Nf=2**10):\n    mse = np.zeros((len(datasets), 2))\n    for i, h_freq in enumerate(datasets):\n        t0 = process_time()\n        h_wavelet = forward_transform(h_freq, Nf=Nf)\n        h_reconstructed = inverse_transform(h_wavelet, dt=h_time.dt)\n        mse[i, 0] = get_mse(h_freq, h_reconstructed)\n        mse[i, 1] = process_time() - t0\n\n    return mse[1:].T\n\n\ndef get_mse(f1, f2):\n    \"\"\"Calculate Mean Squared Error between two frequency series.\"\"\"\n    return float(np.mean((np.abs(f1.data - f2.data) ** 2)[1:-1]))\n\n\nnumpy_mses = get_residuals(\n    datasets, from_freq_to_wavelet, from_wavelet_to_freq\n)\n\njax_mses = get_residuals(\n    datasets, jax_from_freq_to_wavelet, jax_from_wavelet_to_freq\n)\n\n\ncp_mses = None\nif cuda_is_available():\n    from pywavelet.transforms.cupy import (\n        from_freq_to_wavelet as cp_from_freq_to_wavelet,\n    )\n    from pywavelet.transforms.cupy import (\n        from_wavelet_to_freq as cp_from_wavelet_to_freq,\n    )\n\n    cp_mses = get_residuals(\n        datasets, cp_from_freq_to_wavelet, cp_from_wavelet_to_freq\n    )","key":"T3mqZUehjC"},{"type":"outputs","id":"sNFgJU88Ce5MnxBF6qUiy","children":[],"key":"lSQwF5iK1h"}],"key":"fz95VDnlNB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport numpy as np\n\nimport matplotlib.pyplot as plt\n\n# Set the desired RC parameters\nrc_params = {\n    \"xtick.direction\": \"in\",  # Mirrored ticks (in and out)\n    \"ytick.direction\": \"in\",\n    \"xtick.top\": True,  # Show ticks on the top spine\n    \"ytick.right\": True,  # Show ticks on the right spine\n    \"xtick.major.size\": 6,  # Length of major ticks\n    \"ytick.major.size\": 6,\n    \"xtick.minor.size\": 4,  # Length of minor ticks\n    \"ytick.minor.size\": 4,\n    \"xtick.major.pad\": 4,  # Padding between tick and label\n    \"ytick.major.pad\": 4,\n    \"xtick.minor.pad\": 4,\n    \"ytick.minor.pad\": 4,\n    \"font.size\": 14,  # Overall font size\n    \"axes.labelsize\": 16,  # Font size of axis labels\n    \"axes.titlesize\": 18,  # Font size of plot title\n    \"xtick.labelsize\": 12,  # Font size of x-axis tick labels\n    \"ytick.labelsize\": 12,  # Font size of y-axis tick labels\n    \"xtick.major.width\": 2,  # Thickness of major ticks\n    \"ytick.major.width\": 2,  # Thickness of major ticks\n    \"xtick.minor.width\": 1,  # Thickness of minor ticks\n    \"ytick.minor.width\": 1,  # Thickness of minor ticks\n    \"lines.linewidth\": 3,  # Default linewidth for lines in plots\n    \"patch.linewidth\": 4,  # Default linewidth for patches (e.g., rectangles, circles)\n    \"axes.linewidth\": 2,  # Default linewidth for the axes spines\n}\n\n# Apply the RC parameters globally\nplt.rcParams.update(rc_params)\n\nCOLORS = dict(teal=\"#17becf\", gray=\"#c9c9c9\", red=\"#d62728\")\n\n# Data setup\nMSE = [numpy_mses[0], jax_mses[0]] + (\n    [cp_mses[0]] if cp_mses is not None else jax_mses[0]\n)\nruntimes = [numpy_mses[1], jax_mses[1]] + (\n    [cp_mses[1]] if cp_mses is not None else jax_mses[1]\n)\n\nlabels = [\"NumPy\", \"JAX\"] + ([\"CuPy\"] if cp_mses is not None else [])\ncolors = [\"#d62728\", \"#17becf\"] + ([\"#c9c9c9\"] if cp_mses is not None else [])\npositions = np.arange(len(labels)) * 1.0  # Spaced positions\n\nfig, axes = plt.subplots(2, 1, figsize=(4, 5), sharex=True)\n\n\n# Plot helper\ndef make_boxplot(ax, data, title, ylabel):\n    for i, d in enumerate(data):\n        ax.boxplot(\n            d,\n            positions=[positions[i]],\n            widths=0.8,\n            patch_artist=True,\n            boxprops=dict(\n                facecolor=colors[i], alpha=0.4, color=colors[i], linewidth=0\n            ),\n            medianprops=dict(color=colors[i], linewidth=2.5),\n            whiskerprops=dict(color=colors[i], linewidth=2.5),\n            capprops=dict(color=colors[i], linewidth=2.5),\n            flierprops=dict(\n                marker=\"o\", color=colors[i], alpha=0.6, markersize=0\n            ),\n        )\n    # ax.set_title(title)\n    ax.set_ylabel(ylabel)\n    # ax.grid(axis=\"y\", linestyle=\"--\", alpha=0.4)\n\n\nmake_boxplot(axes[0], MSE, \"Mean Squared Errors (MSEs)\", \"MSE\")\nmake_boxplot(axes[1], runtimes, \"Runtimes\", \"Runtime [s]\")\n\naxes[1].set_xticks(positions)\naxes[1].set_xticklabels(labels)\n\n# remove whitespace between subplots\nplt.subplots_adjust(hspace=0)\n\n\n# plt.tight_layout()\nplt.savefig(\"mes.pdf\", dpi=300, bbox_inches=\"tight\")\nplt.show()","key":"TtO4aUB336"},{"type":"outputs","id":"A9UUD6WY9B3nWQmKfrgUc","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ed6005109f58a3347103eb6a60a294f8","path":"/pywavelet//build/ed6005109f58a3347103eb6a60a294f8.png"},"text/plain":{"content":"<Figure size 1000x800 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"C7kiJwFMW5"}],"key":"M650c2Xvpx"}],"key":"dbxEB0iI4n"}],"key":"Vhfzy2utZF"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Runtime Comparisons","url":"/examples/runtime","group":" "},"next":{"title":"EMRI, Galactic Binary, and MBH Transformation examples","url":"/examples/example-signals","group":" "}}},"domain":"http://localhost:3000"}